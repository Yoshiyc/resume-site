import"../chunks/CWj6FrbW.js";import"../chunks/CyICmP6G.js";import{p as $t,l as G,a as te,g as p,f as ee,t as y,b as c,d as re,j as s,i as a,s as x,m as T,e as D,n as t,u as l,r,k as kt,o as jt}from"../chunks/B1QzbS-Z.js";import{s as u,e as J,r as ae}from"../chunks/Dq_TzkNB.js";import{p as Mt,i as f}from"../chunks/C7W3VNac.js";import{e as ie,i as se}from"../chunks/C9On_rf4.js";import{a as K,e as N}from"../chunks/Ks_EKFJL.js";import{r as Q,a as U,s as zt}from"../chunks/DUrMfR5j.js";import{s as oe}from"../chunks/4EBnTZ0z.js";import{a as de}from"../chunks/C0ybvDGb.js";import{i as le}from"../chunks/Btm7-lYI.js";var ne=p('<div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg"><div class="flex items-center"><svg class="w-5 h-5 text-green-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <p class="text-green-800"> </p></div></div>'),ve=p('<div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"><div class="flex items-center"><svg class="w-5 h-5 text-red-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-red-800"> </p></div></div>'),ce=p('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">未讀</span>'),pe=p('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">已回覆</span>'),ue=p('<div class="mt-2"><p class="text-sm font-medium text-gray-700"> </p></div>'),xe=p('<div class="mt-4 p-4 bg-gray-50 rounded-lg"><div class="flex items-center mb-2"><svg class="w-4 h-4 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path></svg> <span class="text-sm font-medium text-gray-700">您的回覆</span> <span class="text-xs text-gray-500 ml-2"> </span></div> <p class="text-gray-700 whitespace-pre-wrap"> </p></div>'),fe=p('<form method="POST" action="?/reply" class="mt-4 p-4 bg-blue-50 rounded-lg"><input type="hidden" name="id"/> <label class="block text-sm font-medium text-gray-700 mb-2">回覆訊息</label> <textarea name="reply_message" rows="4" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" placeholder="輸入您的回覆..."></textarea> <div class="flex justify-end space-x-2 mt-3"><button type="button" class="btn-secondary text-sm">取消</button> <button type="submit" class="btn-primary text-sm">發送回覆</button></div></form>'),_e=p('<form method="POST" action="?/markAsRead" class="inline"><input type="hidden" name="id"/> <button type="submit" class="text-blue-600 hover:text-blue-800 text-sm font-medium">標記為已讀</button></form>'),me=p('<button type="button" class="text-green-600 hover:text-green-800 text-sm font-medium">回覆</button>'),he=p('<div><div class="px-6 py-4 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><div class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div> <div><h3 class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div></div> <div class="flex items-center space-x-2"><!> <!> <span class="text-sm text-gray-500"> </span></div></div> <!></div> <div class="px-6 py-4"><p class="text-gray-700 whitespace-pre-wrap"> </p> <!> <!></div> <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-2"><!> <!> <form method="POST" action="?/delete" class="inline"><input type="hidden" name="id"/> <button type="submit" class="text-red-600 hover:text-red-800 text-sm font-medium">刪除</button></form></div></div>'),be=p('<div class="space-y-6"></div>'),ge=p('<div class="text-center py-12"><div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6"><svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div> <h3 class="text-xl font-semibold text-gray-900 mb-2">還沒有聯絡訊息</h3> <p class="text-gray-600">當有人透過聯絡表單發送訊息時，會在這裡顯示</p></div>'),ye=p('<!> <!> <div class="mb-8"><h1 class="text-2xl font-bold text-gray-900 mb-4">聯絡訊息管理</h1> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="bg-white rounded-lg shadow p-4"><div class="flex items-center"><div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3"><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div> <div><p class="text-sm font-medium text-gray-600">總訊息數</p> <p class="text-2xl font-semibold text-gray-900"> </p></div></div></div> <div class="bg-white rounded-lg shadow p-4"><div class="flex items-center"><div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center mr-3"><svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div> <div><p class="text-sm font-medium text-gray-600">未讀訊息</p> <p class="text-2xl font-semibold text-gray-900"> </p></div></div></div> <div class="bg-white rounded-lg shadow p-4"><div class="flex items-center"><div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <div><p class="text-sm font-medium text-gray-600">已回覆</p> <p class="text-2xl font-semibold text-gray-900"> </p></div></div></div></div></div> <!>',1);function Oe(Bt,L){$t(L,!1);const _=T(),w=T();let X=Mt(L,"data",8),b=Mt(L,"form",8),S=T(!1),k=T(null),z=T("");function Y(o){return new Date(o).toLocaleDateString("zh-TW",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Ct(o){x(k,o),x(z,"")}function Tt(){x(k,null),x(z,"")}function Dt(o,n){return confirm(`確定要刪除來自「${o}」的訊息嗎？此操作無法復原。`)?!0:(n.preventDefault(),!1)}G(()=>(t(_),D(X())),()=>{(o=>{x(_,o.messages)})(X())}),G(()=>D(b()),()=>{var o;(o=b())!=null&&o.success&&(x(S,!0),x(k,null),x(z,""),setTimeout(()=>{x(S,!1)},3e3))}),G(()=>t(_),()=>{x(w,{total:t(_).length,unread:t(_).filter(o=>!o.is_read).length,replied:t(_).filter(o=>o.is_replied).length})}),te(),le();var Z=ye(),$=ee(Z);{var Lt=o=>{var n=ne(),j=a(n),e=s(a(j),2),g=a(e,!0);r(e),r(j),r(n),y(()=>u(g,(D(b()),l(()=>{var M;return((M=b())==null?void 0:M.message)||"操作成功！"})))),c(o,n)};f($,o=>{t(S)&&o(Lt)})}var tt=s($,2);{var St=o=>{var n=ve(),j=a(n),e=s(a(j),2),g=a(e,!0);r(e),r(j),r(n),y(()=>u(g,(D(b()),l(()=>b().error)))),c(o,n)};f(tt,o=>{D(b()),l(()=>{var n;return(n=b())==null?void 0:n.error})&&o(St)})}var O=s(tt,2),et=s(a(O),2),P=a(et),rt=a(P),at=s(a(rt),2),it=s(a(at),2),Ot=a(it,!0);r(it),r(at),r(rt),r(P);var R=s(P,2),st=a(R),ot=s(a(st),2),dt=s(a(ot),2),Pt=a(dt,!0);r(dt),r(ot),r(st),r(R);var lt=s(R,2),nt=a(lt),vt=s(a(nt),2),ct=s(a(vt),2),Rt=a(ct,!0);r(ct),r(vt),r(nt),r(lt),r(et),r(O);var qt=s(O,2);{var Ht=o=>{var n=be();ie(n,5,()=>t(_),se,(j,e)=>{var g=he(),M=a(g),q=a(M),H=a(q),pt=s(a(H),2),V=a(pt),At=a(V,!0);r(V);var ut=s(V,2),It=a(ut,!0);r(ut),r(pt),r(H);var xt=s(H,2),ft=a(xt);{var Wt=i=>{var d=ce();c(i,d)};f(ft,i=>{t(e),l(()=>!t(e).is_read)&&i(Wt)})}var _t=s(ft,2);{var Et=i=>{var d=pe();c(i,d)};f(_t,i=>{t(e),l(()=>t(e).is_replied)&&i(Et)})}var mt=s(_t,2),Ft=a(mt,!0);r(mt),r(xt),r(q);var Gt=s(q,2);{var Jt=i=>{var d=ue(),v=a(d),m=a(v);r(v),r(d),y(()=>u(m,`主旨：${t(e),l(()=>t(e).subject)??""}`)),c(i,d)};f(Gt,i=>{t(e),l(()=>t(e).subject)&&i(Jt)})}r(M);var A=s(M,2),I=a(A),Kt=a(I,!0);r(I);var ht=s(I,2);{var Nt=i=>{var d=xe(),v=a(d),m=s(a(v),4),h=a(m,!0);r(m),r(v);var B=s(v,2),F=a(B,!0);r(B),r(d),y(C=>{u(h,C),u(F,(t(e),l(()=>t(e).reply_message)))},[()=>(t(e),l(()=>t(e).replied_at?Y(t(e).replied_at):""))],kt),c(i,d)};f(ht,i=>{t(e),l(()=>t(e).is_replied&&t(e).reply_message)&&i(Nt)})}var Qt=s(ht,2);{var Ut=i=>{var d=fe(),v=a(d);Q(v);var m=s(v,2),h=s(m,2);ae(h);var B=s(h,2),F=a(B);jt(2),r(B),r(d),K(d,C=>{var wt;return(wt=N)==null?void 0:wt(C)}),y(()=>{U(v,(t(e),l(()=>t(e).id))),zt(m,"for",`reply_message_${t(e),l(()=>t(e).id)??""}`),zt(h,"id",`reply_message_${t(e),l(()=>t(e).id)??""}`)}),de(h,()=>t(z),C=>x(z,C)),J("click",F,Tt),c(i,d)};f(Qt,i=>{t(k),t(e),l(()=>t(k)===t(e).id)&&i(Ut)})}r(A);var bt=s(A,2),gt=a(bt);{var Xt=i=>{var d=_e(),v=a(d);Q(v),jt(2),r(d),K(d,m=>{var h;return(h=N)==null?void 0:h(m)}),y(()=>U(v,(t(e),l(()=>t(e).id)))),c(i,d)};f(gt,i=>{t(e),l(()=>!t(e).is_read)&&i(Xt)})}var yt=s(gt,2);{var Yt=i=>{var d=me();J("click",d,()=>Ct(t(e).id)),c(i,d)};f(yt,i=>{t(e),t(k),l(()=>!t(e).is_replied&&t(k)!==t(e).id)&&i(Yt)})}var W=s(yt,2),E=a(W);Q(E);var Zt=s(E,2);r(W),K(W,i=>{var d;return(d=N)==null?void 0:d(i)}),r(bt),r(g),y(i=>{oe(g,1,`bg-white rounded-lg shadow ${t(e),l(()=>t(e).is_read?"":"ring-2 ring-blue-200")??""}`),u(At,(t(e),l(()=>t(e).name))),u(It,(t(e),l(()=>t(e).email))),u(Ft,i),u(Kt,(t(e),l(()=>t(e).message))),U(E,(t(e),l(()=>t(e).id)))},[()=>(t(e),l(()=>Y(t(e).created_at)))],kt),J("click",Zt,i=>Dt(t(e).name,i)),c(j,g)}),r(n),c(o,n)},Vt=o=>{var n=ge();c(o,n)};f(qt,o=>{t(_),l(()=>t(_).length>0)?o(Ht):o(Vt,!1)})}y(()=>{u(Ot,(t(w),l(()=>t(w).total))),u(Pt,(t(w),l(()=>t(w).unread))),u(Rt,(t(w),l(()=>t(w).replied)))}),c(Bt,Z),re()}export{Oe as component};
